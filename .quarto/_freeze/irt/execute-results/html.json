{
  "hash": "c3ebdd4af345f4eb540b9a6c7170a5fc",
  "result": {
    "markdown": "---\ntitle: \"Item Response\"\nlink-citations: yes\nparams: \n    SHOW_SOLS: TRUE\n    TOGGLE: TRUE\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ltm)\nlibrary(lavaan)\nlibrary(lme4)\n\nmcq <- read_csv(\"data/mcq.csv\")\nsummary(mcq)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      id                 q01              q02              q03      \n Length:184         Min.   :0.0000   Min.   :0.0000   Min.   :0.00  \n Class :character   1st Qu.:1.0000   1st Qu.:0.0000   1st Qu.:0.75  \n Mode  :character   Median :1.0000   Median :1.0000   Median :1.00  \n                    Mean   :0.7717   Mean   :0.6576   Mean   :0.75  \n                    3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.00  \n                    Max.   :1.0000   Max.   :1.0000   Max.   :1.00  \n      q04               q05              q06              q07        \n Min.   :0.00000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  \n 1st Qu.:0.00000   1st Qu.:0.0000   1st Qu.:1.0000   1st Qu.:1.0000  \n Median :0.00000   Median :1.0000   Median :1.0000   Median :1.0000  \n Mean   :0.09239   Mean   :0.6902   Mean   :0.9185   Mean   :0.8804  \n 3rd Qu.:0.00000   3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.0000  \n Max.   :1.00000   Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  \n      q08              q09              q10              q11        \n Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  \n 1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:1.0000  \n Median :0.0000   Median :1.0000   Median :1.0000   Median :1.0000  \n Mean   :0.4728   Mean   :0.7283   Mean   :0.5815   Mean   :0.9293  \n 3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.0000  \n Max.   :1.0000   Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  \n      q12              q13              q14              q15        \n Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  \n 1st Qu.:0.0000   1st Qu.:1.0000   1st Qu.:1.0000   1st Qu.:1.0000  \n Median :0.0000   Median :1.0000   Median :1.0000   Median :1.0000  \n Mean   :0.4185   Mean   :0.9022   Mean   :0.8478   Mean   :0.9185  \n 3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.0000  \n Max.   :1.0000   Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  \n      q16              q17              q18              q19        \n Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  \n 1st Qu.:1.0000   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:1.0000  \n Median :1.0000   Median :0.0000   Median :0.0000   Median :1.0000  \n Mean   :0.8043   Mean   :0.3152   Mean   :0.3587   Mean   :0.7609  \n 3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.0000  \n Max.   :1.0000   Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  \n      q20        \n Min.   :0.0000  \n 1st Qu.:1.0000  \n Median :1.0000  \n Mean   :0.7989  \n 3rd Qu.:1.0000  \n Max.   :1.0000  \n```\n:::\n:::\n\n\n# modelling probability of endorsement\n\n$$P(y=1) = f(X)$$\n\nin straightforward logistic regression, we are modelling:\n\n$$\nP(y=1) = \\frac{e^{\\mathbf{X\\beta}}}{1 + e^{\\mathbf{X\\beta}}} \\\\\n\n\n$$\n\n# 1 parameter model\n\n\n$$\nP(y=1|\\theta, \\delta) = \\mathrm{logis}(\\theta_i-\\delta_j)\n$$\n\n\n$\\pi_{ij}$, is a function of:  \n\n- $\\delta_j$: **difficulty** of item $j$, and\n- $\\theta_i$: the latent trait (**ability**) of person $i$. \n\n$$\n\\mathrm{logit_{ij}} = \\mathrm{log}(\\frac{\\pi_{ij}}{1-\\pi_{ij}}) = \\theta_i-\\delta_j\n$$\n\ndiscrimination parameter: \nwe can add $\\alpha$ into the mix, which will denote the ability to distinguish one person from another. In the 1PM model, it is held constant (i.e. each item $j$ has the same ability to discriminate between people). We'll change this later on. \n\n\n$$\nP(y=1|\\theta, \\delta) = \\mathrm{logis}(\\alpha(\\theta_i-\\delta_j))\n$$\n\n# fitting with ltm\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nirt_rasch1 = rasch(mcq[,-1], IRT.param=F)\nirt_rasch1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nrasch(data = mcq[, -1], IRT.param = F)\n\nCoefficients:\n   q01     q02     q03     q04     q05     q06     q07     q08     q09     q10  \n 1.349   0.728   1.219  -2.489   0.892   2.630   2.184  -0.120   1.095   0.369  \n   q11     q12     q13     q14     q15     q16     q17     q18     q19     q20  \n 2.791  -0.366   2.421   1.887   2.629   1.561  -0.863  -0.647   1.283   1.524  \n     z  \n 0.721  \n\nLog.Lik: -1799.836\n```\n:::\n:::\n\nthe coefficients are the $\\delta_j$ values - the difficulty of each item.  \ncoefficients are telling us that Qs 4, 12, 17, 18 are less likely to be endorsed\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nirt_rasch2 = rasch(mcq[,-1], IRT.param=T)\nirt_rasch2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nrasch(data = mcq[, -1], IRT.param = T)\n\nCoefficients:\nDffclt.q01  Dffclt.q02  Dffclt.q03  Dffclt.q04  Dffclt.q05  Dffclt.q06  \n    -1.871      -1.010      -1.690       3.451      -1.237      -3.646  \nDffclt.q07  Dffclt.q08  Dffclt.q09  Dffclt.q10  Dffclt.q11  Dffclt.q12  \n    -3.028       0.167      -1.519      -0.511      -3.870       0.508  \nDffclt.q13  Dffclt.q14  Dffclt.q15  Dffclt.q16  Dffclt.q17  Dffclt.q18  \n    -3.356      -2.617      -3.646      -2.165       1.196       0.897  \nDffclt.q19  Dffclt.q20      Dscrmn  \n    -1.779      -2.113       0.721  \n\nLog.Lik: -1799.836\n```\n:::\n:::\n\nthis parameterization is telling us that Qs 4, 12, 17, 18 require being above average on the latent trait \n\n# as a mixed model\n\n$$\nP(y=1|\\theta, \\delta) = \\mathrm{logis}(\\alpha(\\theta_i-\\delta_j))\n$$\n\n$$\nP(y_{ij}=1) = \\mathrm{logis}(\\beta_{0i} + \\beta_j\\text{(Item)} + \\varepsilon_{ij})  \\\\\n\\beta_{00} = \\zeta_i \\\\\n\n\n$$\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmcqlong <- \n  mcq %>%\n  pivot_longer(2:21)\n\nmmod = glmer(value ~ -1 + name + (1 |id), mcqlong, family=\"binomial\",\n             control = glmerControl(optimizer=\"bobyqa\"))\n```\n:::\n\n\nthe fixed effects are our item difficulties:\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncbind(irt_rasch1$coefficients[,1], fixef(mmod)) %>%\n  head\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          [,1]       [,2]\nq01  1.3491038  1.3490374\nq02  0.7282649  0.7282403\nq03  1.2187227  1.2188539\nq04 -2.4890740 -2.4867295\nq05  0.8924063  0.8924002\nq06  2.6297960  2.6268738\n```\n:::\n:::\n\n\n\n# plots\n\n## item characteristic curves\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot(irt_rasch1, type=\"ICC\")\n```\n\n::: {.cell-output-display}\n![](irt_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\nwhat the hell are they? well, let's make them ourselves:\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# here are the item coefficients and discrimination parameter\nbetas <- irt_rasch1$coefficients\n# we'll take the latent ability variable z from -4 to 4. \nz = seq(-4,4,length.out=100)\n# essentially, the discrimination parameter defines the slope (in logits)\n# the item difficulty defines the intercept adjustment\nlogits = cbind(1,z) %*% t(betas)\n\ncbind(z,logits) %>%\n  as_tibble() %>%\n  pivot_longer(2:21) %>%\n  ggplot(., aes(x=z,y=value,col=name))+\n  geom_line(lwd=1)+\n  labs(title=\"in logits\",ylab=\"logodds\",xlab=\"ability\") + \n\n  cbind(z,plogis(logits)) %>%\n    as_tibble() %>%\n    pivot_longer(2:21) %>%\n    ggplot(., aes(x=z,y=value,col=name))+\n    geom_line(lwd=1)+\n    labs(title=\"in probability\",ylab=\"probability\",xlab=\"ability\")\n```\n\n::: {.cell-output-display}\n![](irt_files/figure-html/unnamed-chunk-8-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n\n<div class=\"optional-begin\"><span id='opt-start-1' class=\"fa fa-hand-o-right optional-icon clickable\" onclick=\"toggle_visibility('opt-body-1', 'opt-start-1')\"> <span class=\"olab\">Optional taken from the mixed model</span></span></div><div class=\"optional-body\" id = \"opt-body-1\" style=\"display: none;\">\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# we need the fixed effects, and the discrimination parameter. \n# the discrimination parameter in the GLMM is the random intercept variance!  \nbetas <- cbind(fixef(mmod), sqrt(VarCorr(mmod)$id[[1]]) )\n# plot across z\nz = seq(-4,4,length.out=100)\n# as before\nlogits = cbind(1,z) %*% t(betas)\n\ncbind(z,plogis(logits)) %>%\n  as_tibble %>%\n  pivot_longer(2:21) %>%\n  ggplot(., aes(x=z,y=value,col=name))+\n  geom_line(lwd=1)\n```\n\n::: {.cell-output-display}\n![](irt_files/figure-html/unnamed-chunk-9-1.png){fig-align='center' width=80%}\n:::\n\n```{.r .cell-code}\n# LETS DO THIS EVEN MORE MANUALLY\n# for those who don't like matrix operations\ntibble(\n  item = rep(1:20,e=100),\n  z = rep(z, 20),\n  y = z * sqrt(VarCorr(mmod)$id[[1]]),\n) %>%\n  mutate(\n    coef = map_dbl(item, ~fixef(mmod)[.]),\n    y = y + coef,\n    p = plogis(y)\n  ) %>%\n  ggplot(., aes(x=z,y=p,col=factor(item)))+\n  geom_line()\n```\n\n::: {.cell-output-display}\n![](irt_files/figure-html/unnamed-chunk-9-2.png){fig-align='center' width=80%}\n:::\n\n```{.r .cell-code}\n# if it helps, think about what the plot is for:\n# mmod = glmer(value ~ -1 + name + (1 |id), mcqlong, family=\"binomial\",\n#             control = glmerControl(optimizer=\"bobyqa\"))\n# we're plotting *across* ability (the random intercepts)\n# the curve will center at plogis(0)\n```\n:::\n\n\n\n\n</div><p class=\"optional-end\"></p>\n\n\n\n\n## item information curves\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nbetas <- irt_rasch1$coefficients\n# plot across z\nz = seq(-4,4,length.out=100)\n\nlogits = cbind(1,z) %*% t(betas)\nplogis(logits)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             q01       q02       q03         q04       q05       q06       q07\n  [1,] 0.1771342 0.1037045 0.1589225 0.004613871 0.1199838 0.4365456 0.3315148\n  [2,] 0.1857897 0.1092483 0.1668687 0.004889416 0.1262753 0.4509307 0.3445553\n  [3,] 0.1947681 0.1150505 0.1751294 0.005181332 0.1328469 0.4653983 0.3578343\n  [4,] 0.2040717 0.1211189 0.1837088 0.005490580 0.1397058 0.4799244 0.3713350\n  [5,] 0.2137017 0.1274613 0.1926105 0.005818177 0.1468589 0.4944845 0.3850397\n  [6,] 0.2236584 0.1340851 0.2018368 0.006165200 0.1543125 0.5090539 0.3989292\n  [7,] 0.2339410 0.1409976 0.2113893 0.006532784 0.1620725 0.5236080 0.4129833\n  [8,] 0.2445475 0.1482054 0.2212687 0.006922132 0.1701443 0.5381221 0.4271806\n  [9,] 0.2554744 0.1557149 0.2314742 0.007334514 0.1785324 0.5525718 0.4414990\n [10,] 0.2667173 0.1635318 0.2420041 0.007771270 0.1872407 0.5669333 0.4559152\n [11,] 0.2782699 0.1716613 0.2528555 0.008233819 0.1962724 0.5811833 0.4704057\n [12,] 0.2901250 0.1801080 0.2640239 0.008723657 0.2056294 0.5952990 0.4849463\n [13,] 0.3022736 0.1888755 0.2755037 0.009242365 0.2153130 0.6092588 0.4995124\n [14,] 0.3147054 0.1979668 0.2872879 0.009791610 0.2253233 0.6230421 0.5140793\n [15,] 0.3274086 0.2073838 0.2993678 0.010373153 0.2356593 0.6366291 0.5286224\n [16,] 0.3403698 0.2171274 0.3117335 0.010988852 0.2463186 0.6500015 0.5431170\n [17,] 0.3535745 0.2271977 0.3243735 0.011640666 0.2572977 0.6631422 0.5575390\n [18,] 0.3670063 0.2375932 0.3372748 0.012330661 0.2685918 0.6760354 0.5718646\n [19,] 0.3806480 0.2483116 0.3504231 0.013061014 0.2801947 0.6886667 0.5860707\n [20,] 0.3944807 0.2593490 0.3638027 0.013834021 0.2920986 0.7010235 0.6001351\n [21,] 0.4084846 0.2707003 0.3773963 0.014652098 0.3042944 0.7130940 0.6140363\n [22,] 0.4226386 0.2823591 0.3911855 0.015517792 0.3167716 0.7248686 0.6277539\n [23,] 0.4369208 0.2943173 0.4051506 0.016433780 0.3295180 0.7363385 0.6412689\n [24,] 0.4513084 0.3065657 0.4192710 0.017402882 0.3425203 0.7474969 0.6545632\n [25,] 0.4657778 0.3190933 0.4335249 0.018428061 0.3557633 0.7583380 0.6676202\n [26,] 0.4803051 0.3318878 0.4478896 0.019512433 0.3692309 0.7688576 0.6804246\n [27,] 0.4948657 0.3449354 0.4623417 0.020659269 0.3829052 0.7790527 0.6929626\n [28,] 0.5094351 0.3582210 0.4768575 0.021872008 0.3967674 0.7889216 0.7052217\n [29,] 0.5239884 0.3717279 0.4914125 0.023154253 0.4107974 0.7984637 0.7171912\n [30,] 0.5385012 0.3854382 0.5059820 0.024509786 0.4249740 0.8076795 0.7288615\n [31,] 0.5529489 0.3993327 0.5205413 0.025942569 0.4392750 0.8165708 0.7402247\n [32,] 0.5673078 0.4133913 0.5350659 0.027456752 0.4536777 0.8251400 0.7512742\n [33,] 0.5815545 0.4275924 0.5495312 0.029056676 0.4681583 0.8333906 0.7620047\n [34,] 0.5956664 0.4419139 0.5639133 0.030746882 0.4826927 0.8413267 0.7724126\n [35,] 0.6096219 0.4563326 0.5781887 0.032532112 0.4972565 0.8489533 0.7824953\n [36,] 0.6234002 0.4708249 0.5923346 0.034417315 0.5118249 0.8562760 0.7922514\n [37,] 0.6369819 0.4853666 0.6063290 0.036407652 0.5263732 0.8633008 0.8016808\n [38,] 0.6503484 0.4999330 0.6201512 0.038508500 0.5408770 0.8700344 0.8107844\n [39,] 0.6634828 0.5144996 0.6337811 0.040725450 0.5553117 0.8764838 0.8195642\n [40,] 0.6763693 0.5290416 0.6472003 0.043064315 0.5696538 0.8826563 0.8280230\n [41,] 0.6889937 0.5435345 0.6603912 0.045531125 0.5838799 0.8885595 0.8361646\n [42,] 0.7013430 0.5579540 0.6733378 0.048132132 0.5979676 0.8942014 0.8439933\n [43,] 0.7134060 0.5722765 0.6860255 0.050873803 0.6118954 0.8995899 0.8515144\n [44,] 0.7251727 0.5864788 0.6984411 0.053762824 0.6256428 0.9047332 0.8587335\n [45,] 0.7366346 0.6005388 0.7105729 0.056806087 0.6391904 0.9096395 0.8656571\n [46,] 0.7477847 0.6144349 0.7224107 0.060010690 0.6525200 0.9143171 0.8722918\n [47,] 0.7586174 0.6281470 0.7339455 0.063383925 0.6656147 0.9187742 0.8786448\n [48,] 0.7691286 0.6416559 0.7451701 0.066933271 0.6784592 0.9230189 0.8847235\n [49,] 0.7793151 0.6549435 0.7560785 0.070666375 0.6910392 0.9270594 0.8905356\n [50,] 0.7891755 0.6679934 0.7666662 0.074591043 0.7033423 0.9309037 0.8960891\n [51,] 0.7987090 0.6807903 0.7769299 0.078715217 0.7153573 0.9345597 0.9013921\n [52,] 0.8079164 0.6933204 0.7868676 0.083046955 0.7270745 0.9380351 0.9064527\n [53,] 0.8167992 0.7055714 0.7964786 0.087594407 0.7384857 0.9413376 0.9112791\n [54,] 0.8253600 0.7175324 0.8057632 0.092365783 0.7495841 0.9444744 0.9158797\n [55,] 0.8336023 0.7291939 0.8147227 0.097369326 0.7603643 0.9474529 0.9202625\n [56,] 0.8415302 0.7405481 0.8233596 0.102613272 0.7708224 0.9502800 0.9244359\n [57,] 0.8491488 0.7515884 0.8316770 0.108105813 0.7809555 0.9529626 0.9284078\n [58,] 0.8564636 0.7623097 0.8396791 0.113855050 0.7907622 0.9555072 0.9321862\n [59,] 0.8634808 0.7727083 0.8473705 0.119868948 0.8002422 0.9579203 0.9357791\n [60,] 0.8702068 0.7827815 0.8547568 0.126155281 0.8093961 0.9602079 0.9391939\n [61,] 0.8766488 0.7925281 0.8618439 0.132721576 0.8182259 0.9623760 0.9424384\n [62,] 0.8828142 0.8019481 0.8686384 0.139575053 0.8267342 0.9644304 0.9455198\n [63,] 0.8887105 0.8110424 0.8751471 0.146722559 0.8349246 0.9663765 0.9484453\n [64,] 0.8943456 0.8198129 0.8813773 0.154170498 0.8428014 0.9682197 0.9512218\n [65,] 0.8997276 0.8282625 0.8873367 0.161924764 0.8503698 0.9699649 0.9538560\n [66,] 0.9048646 0.8363949 0.8930330 0.169990661 0.8576353 0.9716171 0.9563545\n [67,] 0.9097648 0.8442147 0.8984743 0.178372828 0.8646042 0.9731810 0.9587236\n [68,] 0.9144365 0.8517270 0.9036686 0.187075157 0.8712832 0.9746609 0.9609693\n [69,] 0.9188879 0.8589375 0.9086242 0.196100717 0.8776793 0.9760612 0.9630975\n [70,] 0.9231272 0.8658526 0.9133493 0.205451672 0.8837999 0.9773859 0.9651139\n [71,] 0.9271625 0.8724791 0.9178522 0.215129196 0.8896528 0.9786389 0.9670239\n [72,] 0.9310018 0.8788241 0.9221410 0.225133404 0.8952459 0.9798239 0.9688327\n [73,] 0.9346529 0.8848950 0.9262239 0.235463271 0.9005871 0.9809444 0.9705454\n [74,] 0.9381237 0.8906995 0.9301090 0.246116562 0.9056847 0.9820039 0.9721666\n [75,] 0.9414218 0.8962457 0.9338040 0.257089769 0.9105469 0.9830054 0.9737010\n [76,] 0.9445544 0.9015416 0.9373169 0.268378054 0.9151818 0.9839522 0.9751529\n [77,] 0.9475288 0.9065953 0.9406552 0.279975193 0.9195979 0.9848470 0.9765267\n [78,] 0.9503521 0.9114151 0.9438264 0.291873545 0.9238031 0.9856926 0.9778262\n [79,] 0.9530309 0.9160092 0.9468377 0.304064015 0.9278057 0.9864917 0.9790553\n [80,] 0.9555720 0.9203859 0.9496961 0.316536042 0.9316136 0.9872467 0.9802177\n [81,] 0.9579817 0.9245533 0.9524086 0.329277596 0.9352346 0.9879601 0.9813167\n [82,] 0.9602661 0.9285195 0.9549818 0.342275186 0.9386766 0.9886340 0.9823559\n [83,] 0.9624312 0.9322925 0.9574220 0.355513888 0.9419469 0.9892706 0.9833382\n [84,] 0.9644827 0.9358801 0.9597356 0.368977386 0.9450531 0.9898719 0.9842667\n [85,] 0.9664260 0.9392900 0.9619285 0.382648031 0.9480023 0.9904399 0.9851442\n [86,] 0.9682666 0.9425296 0.9640064 0.396506913 0.9508014 0.9909762 0.9859735\n [87,] 0.9700093 0.9456064 0.9659749 0.410533952 0.9534572 0.9914828 0.9867571\n [88,] 0.9716592 0.9485275 0.9678393 0.424707998 0.9559763 0.9919611 0.9874975\n [89,] 0.9732208 0.9512998 0.9696048 0.439006954 0.9583650 0.9924128 0.9881970\n [90,] 0.9746986 0.9539300 0.9712762 0.453407905 0.9606294 0.9928393 0.9888578\n [91,] 0.9760968 0.9564247 0.9728583 0.467887258 0.9627755 0.9932420 0.9894820\n [92,] 0.9774196 0.9587901 0.9743556 0.482420897 0.9648088 0.9936221 0.9900716\n [93,] 0.9786707 0.9610323 0.9757723 0.496984339 0.9667350 0.9939811 0.9906284\n [94,] 0.9798540 0.9631573 0.9771126 0.511552901 0.9685591 0.9943199 0.9911543\n [95,] 0.9809729 0.9651705 0.9783804 0.526101861 0.9702863 0.9946398 0.9916510\n [96,] 0.9820308 0.9670776 0.9795795 0.540606636 0.9719213 0.9949417 0.9921199\n [97,] 0.9830309 0.9688835 0.9807133 0.555042936 0.9734689 0.9952267 0.9925628\n [98,] 0.9839762 0.9705934 0.9817854 0.569386933 0.9749333 0.9954958 0.9929809\n [99,] 0.9848697 0.9722121 0.9827989 0.583615415 0.9763189 0.9957497 0.9933756\n[100,] 0.9857141 0.9737440 0.9837569 0.597705928 0.9776297 0.9959894 0.9937483\n              q08       q09        q10       q11        q12       q13       q14\n  [1,] 0.04718635 0.1431205 0.07471769 0.4765107 0.03728222 0.3859310 0.2693990\n  [2,] 0.04987697 0.1504179 0.07884827 0.4910650 0.03943147 0.3998318 0.2810233\n  [3,] 0.05271252 0.1580186 0.08318666 0.5056345 0.04169925 0.4138958 0.2929481\n  [4,] 0.05569983 0.1659285 0.08774103 0.5201944 0.04409147 0.4281016 0.3051641\n  [5,] 0.05884592 0.1741524 0.09251959 0.5347201 0.04661426 0.4424269 0.3176606\n  [6,] 0.06215802 0.1826946 0.09753057 0.5491871 0.04927394 0.4568487 0.3304256\n  [7,] 0.06564352 0.1915586 0.10278221 0.5635715 0.05207710 0.4713432 0.3434453\n  [8,] 0.06931004 0.2007471 0.10828270 0.5778496 0.05503049 0.4858862 0.3567047\n  [9,] 0.07316531 0.2102616 0.11404014 0.5919988 0.05814110 0.5004531 0.3701874\n [10,] 0.07721723 0.2201030 0.12006249 0.6059972 0.06141611 0.5150192 0.3838756\n [11,] 0.08147382 0.2302706 0.12635752 0.6198237 0.06486289 0.5295599 0.3977503\n [12,] 0.08594321 0.2407629 0.13293274 0.6334585 0.06848900 0.5440505 0.4117913\n [13,] 0.09063358 0.2515771 0.13979536 0.6468828 0.07230215 0.5584670 0.4259774\n [14,] 0.09555316 0.2627089 0.14695222 0.6600793 0.07631020 0.5727856 0.4402864\n [15,] 0.10071021 0.2741529 0.15440971 0.6730320 0.08052116 0.5869832 0.4546953\n [16,] 0.10611293 0.2859021 0.16217370 0.6857260 0.08494312 0.6010377 0.4691804\n [17,] 0.11176947 0.2979481 0.17024948 0.6981483 0.08958426 0.6149276 0.4837177\n [18,] 0.11768783 0.3102811 0.17864166 0.7102870 0.09445280 0.6286328 0.4982826\n [19,] 0.12387588 0.3228898 0.18735411 0.7221318 0.09955700 0.6421340 0.5128505\n [20,] 0.13034123 0.3357615 0.19638988 0.7336740 0.10490507 0.6554135 0.5273965\n [21,] 0.13709122 0.3488819 0.20575110 0.7449060 0.11050518 0.6684546 0.5418961\n [22,] 0.14413284 0.3622354 0.21543890 0.7558221 0.11636537 0.6812422 0.5563252\n [23,] 0.15147265 0.3758050 0.22545337 0.7664174 0.12249353 0.6937625 0.5706598\n [24,] 0.15911675 0.3895724 0.23579345 0.7766889 0.12889735 0.7060033 0.5848769\n [25,] 0.16707066 0.4035182 0.24645687 0.7866344 0.13558423 0.7179538 0.5989540\n [26,] 0.17533926 0.4176216 0.25744007 0.7962532 0.14256122 0.7296045 0.6128698\n [27,] 0.18392672 0.4318611 0.26873817 0.8055455 0.14983502 0.7409476 0.6266037\n [28,] 0.19283641 0.4462141 0.28034491 0.8145128 0.15741181 0.7519766 0.6401365\n [29,] 0.20207084 0.4606573 0.29225259 0.8231574 0.16529724 0.7626864 0.6534501\n [30,] 0.21163153 0.4751669 0.30445209 0.8314824 0.17349635 0.7730734 0.6665277\n [31,] 0.22151899 0.4897186 0.31693278 0.8394919 0.18201348 0.7831350 0.6793540\n [32,] 0.23173261 0.5042877 0.32968260 0.8471907 0.19085216 0.7928700 0.6919150\n [33,] 0.24227060 0.5188495 0.34268801 0.8545842 0.20001511 0.8022783 0.7041981\n [34,] 0.25312991 0.5333794 0.35593404 0.8616783 0.20950408 0.8113610 0.7161924\n [35,] 0.26430618 0.5478528 0.36940433 0.8684797 0.21931980 0.8201199 0.7278883\n [36,] 0.27579370 0.5622458 0.38308119 0.8749951 0.22946191 0.8285582 0.7392777\n [37,] 0.28758532 0.5765347 0.39694567 0.8812319 0.23992889 0.8366794 0.7503538\n [38,] 0.29967248 0.5906968 0.41097766 0.8871976 0.25071796 0.8444881 0.7611115\n [39,] 0.31204515 0.6047100 0.42515598 0.8929002 0.26182507 0.8519895 0.7715467\n [40,] 0.32469181 0.6185532 0.43945850 0.8983474 0.27324480 0.8591894 0.7816569\n [41,] 0.33759950 0.6322065 0.45386228 0.9035475 0.28497033 0.8660941 0.7914406\n [42,] 0.35075379 0.6456511 0.46834371 0.9085087 0.29699340 0.8727104 0.8008975\n [43,] 0.36413887 0.6588694 0.48287866 0.9132393 0.30930431 0.8790454 0.8100286\n [44,] 0.37773756 0.6718452 0.49744264 0.9177473 0.32189186 0.8851067 0.8188356\n [45,] 0.39153139 0.6845637 0.51201096 0.9220412 0.33474341 0.8909019 0.8273214\n [46,] 0.40550068 0.6970116 0.52655890 0.9261289 0.34784487 0.8964390 0.8354896\n [47,] 0.41962466 0.7091770 0.54106189 0.9300185 0.36118070 0.9017260 0.8433445\n [48,] 0.43388155 0.7210494 0.55549565 0.9337180 0.37473402 0.9067713 0.8508913\n [49,] 0.44824871 0.7326199 0.56983636 0.9372352 0.38848664 0.9115829 0.8581357\n [50,] 0.46270277 0.7438809 0.58406084 0.9405775 0.40241914 0.9161691 0.8650840\n [51,] 0.47721980 0.7548263 0.59814666 0.9437526 0.41651098 0.9205382 0.8717428\n [52,] 0.49177541 0.7654515 0.61207229 0.9467676 0.43074060 0.9246983 0.8781193\n [53,] 0.50634499 0.7757530 0.62581724 0.9496297 0.44508552 0.9286575 0.8842208\n [54,] 0.52090379 0.7857287 0.63936212 0.9523456 0.45952254 0.9324237 0.8900552\n [55,] 0.53542717 0.7953777 0.65268880 0.9549220 0.47402782 0.9360048 0.8956302\n [56,] 0.54989072 0.8047002 0.66578045 0.9573653 0.48857706 0.9394085 0.9009540\n [57,] 0.56427042 0.8136974 0.67862161 0.9596819 0.50314569 0.9426422 0.9060347\n [58,] 0.57854282 0.8223717 0.69119823 0.9618775 0.51770897 0.9457133 0.9108806\n [59,] 0.59268519 0.8307261 0.70349772 0.9639581 0.53224223 0.9486290 0.9154999\n [60,] 0.60667563 0.8387646 0.71550896 0.9659291 0.54672099 0.9513961 0.9199008\n [61,] 0.62049323 0.8464919 0.72722229 0.9677960 0.56112114 0.9540213 0.9240915\n [62,] 0.63411816 0.8539133 0.73862951 0.9695638 0.57541908 0.9565113 0.9280801\n [63,] 0.64753180 0.8610349 0.74972388 0.9712374 0.58959191 0.9588722 0.9318746\n [64,] 0.66071679 0.8678630 0.76050002 0.9728216 0.60361754 0.9611102 0.9354828\n [65,] 0.67365713 0.8744046 0.77095392 0.9743208 0.61747483 0.9632310 0.9389124\n [66,] 0.68633823 0.8806668 0.78108288 0.9757394 0.63114371 0.9652404 0.9421710\n [67,] 0.69874693 0.8866573 0.79088540 0.9770815 0.64460528 0.9671437 0.9452659\n [68,] 0.71087152 0.8923838 0.80036118 0.9783510 0.65784190 0.9689462 0.9482042\n [69,] 0.72270179 0.8978543 0.80951100 0.9795516 0.67083726 0.9706527 0.9509930\n [70,] 0.73422897 0.9030770 0.81833664 0.9806870 0.68357647 0.9722682 0.9536390\n [71,] 0.74544576 0.9080599 0.82684085 0.9817605 0.69604604 0.9737971 0.9561487\n [72,] 0.75634623 0.9128114 0.83502721 0.9827754 0.70823394 0.9752439 0.9585285\n [73,] 0.76692588 0.9173397 0.84290008 0.9837347 0.72012965 0.9766128 0.9607844\n [74,] 0.77718148 0.9216530 0.85046452 0.9846414 0.73172406 0.9779076 0.9629223\n [75,] 0.78711108 0.9257594 0.85772620 0.9854984 0.74300956 0.9791323 0.9649479\n [76,] 0.79671393 0.9296671 0.86469136 0.9863082 0.75397993 0.9802905 0.9668667\n [77,] 0.80599039 0.9333838 0.87136666 0.9870733 0.76463035 0.9813856 0.9686839\n [78,] 0.81494186 0.9369175 0.87775920 0.9877963 0.77495732 0.9824210 0.9704044\n [79,] 0.82357073 0.9402757 0.88387640 0.9884792 0.78495861 0.9833997 0.9720332\n [80,] 0.83188025 0.9434659 0.88972593 0.9891244 0.79463322 0.9843248 0.9735747\n [81,] 0.83987450 0.9464954 0.89531571 0.9897338 0.80398126 0.9851992 0.9750335\n [82,] 0.84755827 0.9493713 0.90065377 0.9903094 0.81300393 0.9860254 0.9764136\n [83,] 0.85493702 0.9521005 0.90574830 0.9908531 0.82170339 0.9868062 0.9777193\n [84,] 0.86201675 0.9546895 0.91060750 0.9913665 0.83008271 0.9875439 0.9789542\n [85,] 0.86880399 0.9571449 0.91523963 0.9918513 0.83814581 0.9882408 0.9801220\n [86,] 0.87530566 0.9594729 0.91965291 0.9923091 0.84589731 0.9888992 0.9812263\n [87,] 0.88152906 0.9616795 0.92385551 0.9927414 0.85334255 0.9895211 0.9822704\n [88,] 0.88748179 0.9637704 0.92785554 0.9931495 0.86048740 0.9901085 0.9832574\n [89,] 0.89317166 0.9657514 0.93166099 0.9935349 0.86733828 0.9906633 0.9841903\n [90,] 0.89860667 0.9676277 0.93527971 0.9938987 0.87390205 0.9911873 0.9850720\n [91,] 0.90379496 0.9694044 0.93871941 0.9942421 0.88018591 0.9916821 0.9859053\n [92,] 0.90874472 0.9710865 0.94198764 0.9945663 0.88619742 0.9921493 0.9866927\n [93,] 0.91346420 0.9726788 0.94509177 0.9948724 0.89194433 0.9925905 0.9874366\n [94,] 0.91796164 0.9741857 0.94803896 0.9951613 0.89743461 0.9930070 0.9881395\n [95,] 0.92224523 0.9756116 0.95083619 0.9954340 0.90267638 0.9934004 0.9888035\n [96,] 0.92632310 0.9769606 0.95349022 0.9956914 0.90767781 0.9937717 0.9894307\n [97,] 0.93020330 0.9782366 0.95600761 0.9959343 0.91244715 0.9941222 0.9900231\n [98,] 0.93389373 0.9794434 0.95839469 0.9961636 0.91699264 0.9944532 0.9905827\n [99,] 0.93740216 0.9805847 0.96065757 0.9963801 0.92132249 0.9947656 0.9911111\n[100,] 0.94073621 0.9816638 0.96280215 0.9965843 0.92544485 0.9950605 0.9916101\n             q15       q16        q17        q18       q19       q20\n  [1,] 0.4364501 0.2101847 0.02302774 0.02842024 0.1676885 0.2040627\n  [2,] 0.4508346 0.2200234 0.02437605 0.03007457 0.1759812 0.2136924\n  [3,] 0.4653017 0.2301885 0.02580122 0.03182205 0.1845931 0.2236488\n  [4,] 0.4798275 0.2406782 0.02730739 0.03366754 0.1935274 0.2339312\n  [5,] 0.4943874 0.2514899 0.02889887 0.03561611 0.2027866 0.2445373\n  [6,] 0.5089569 0.2626192 0.03058018 0.03767307 0.2123722 0.2554640\n  [7,] 0.5235111 0.2740607 0.03235606 0.03984392 0.2222845 0.2667065\n  [8,] 0.5380256 0.2858075 0.03423142 0.04213438 0.2325228 0.2782589\n  [9,] 0.5524758 0.2978511 0.03621141 0.04455040 0.2430854 0.2901137\n [10,] 0.5668380 0.3101819 0.03830138 0.04709815 0.2539690 0.3022620\n [11,] 0.5810888 0.3227885 0.04050691 0.04978400 0.2651691 0.3146935\n [12,] 0.5952055 0.3356581 0.04283379 0.05261457 0.2766801 0.3273965\n [13,] 0.6091664 0.3487766 0.04528802 0.05559665 0.2884945 0.3403575\n [14,] 0.6229509 0.3621283 0.04787583 0.05873728 0.3006037 0.3535619\n [15,] 0.6365393 0.3756963 0.05060368 0.06204366 0.3129977 0.3669935\n [16,] 0.6499132 0.3894622 0.05347823 0.06552320 0.3256647 0.3806350\n [17,] 0.6630554 0.4034066 0.05650634 0.06918349 0.3385916 0.3944676\n [18,] 0.6759503 0.4175089 0.05969510 0.07303228 0.3517641 0.4084713\n [19,] 0.6885835 0.4317474 0.06305179 0.07707744 0.3651660 0.4226252\n [20,] 0.7009421 0.4460996 0.06658386 0.08132701 0.3787802 0.4369073\n [21,] 0.7130146 0.4605422 0.07029894 0.08578909 0.3925881 0.4512948\n [22,] 0.7247911 0.4750513 0.07420484 0.09047188 0.4065699 0.4657641\n [23,] 0.7362632 0.4896028 0.07830946 0.09538361 0.4207047 0.4802914\n [24,] 0.7474236 0.5041718 0.08262087 0.10053253 0.4349708 0.4948520\n [25,] 0.7582669 0.5187338 0.08714721 0.10592684 0.4493454 0.5094213\n [26,] 0.7687886 0.5332640 0.09189668 0.11157469 0.4638051 0.5239747\n [27,] 0.7789859 0.5477380 0.09687753 0.11748411 0.4783260 0.5384875\n [28,] 0.7888569 0.5621317 0.10209798 0.12366295 0.4928835 0.5529353\n [29,] 0.7984012 0.5764216 0.10756625 0.13011883 0.5074531 0.5672943\n [30,] 0.8076192 0.5905848 0.11329043 0.13685912 0.5220101 0.5815411\n [31,] 0.8165127 0.6045992 0.11927852 0.14389080 0.5365298 0.5956532\n [32,] 0.8250840 0.6184439 0.12553831 0.15122047 0.5509878 0.6096088\n [33,] 0.8333367 0.6320988 0.13207734 0.15885423 0.5653601 0.6233873\n [34,] 0.8412749 0.6455451 0.13890288 0.16679761 0.5796234 0.6369691\n [35,] 0.8489036 0.6587652 0.14602181 0.17505554 0.5937550 0.6503359\n [36,] 0.8562282 0.6717430 0.15344057 0.18363220 0.6077330 0.6634705\n [37,] 0.8632550 0.6844637 0.16116512 0.19253099 0.6215366 0.6763573\n [38,] 0.8699905 0.6969138 0.16920082 0.20175445 0.6351461 0.6889819\n [39,] 0.8764418 0.7090814 0.17755237 0.21130413 0.6485430 0.7013315\n [40,] 0.8826161 0.7209562 0.18622374 0.22118059 0.6617099 0.7133948\n [41,] 0.8885211 0.7325291 0.19521809 0.23138325 0.6746310 0.7251617\n [42,] 0.8941647 0.7437926 0.20453767 0.24191035 0.6872919 0.7366239\n [43,] 0.8995548 0.7547405 0.21418374 0.25275890 0.6996793 0.7477743\n [44,] 0.9046998 0.7653683 0.22415654 0.26392458 0.7117819 0.7586074\n [45,] 0.9096076 0.7756724 0.23445515 0.27540172 0.7235894 0.7691188\n [46,] 0.9142867 0.7856507 0.24507745 0.28718323 0.7350932 0.7793057\n [47,] 0.9187452 0.7953023 0.25602006 0.29926059 0.7462861 0.7891663\n [48,] 0.9229913 0.8046273 0.26727827 0.31162381 0.7571623 0.7987002\n [49,] 0.9270331 0.8136272 0.27884600 0.32426145 0.7677174 0.8079078\n [50,] 0.9308787 0.8223040 0.29071574 0.33716057 0.7779483 0.8167909\n [51,] 0.9345360 0.8306609 0.30287854 0.35030680 0.7878530 0.8253521\n [52,] 0.9380126 0.8387019 0.31532397 0.36368438 0.7974310 0.8335946\n [53,] 0.9413161 0.8464316 0.32804015 0.37727617 0.8066827 0.8415229\n [54,] 0.9444541 0.8538555 0.34101373 0.39106374 0.8156095 0.8491418\n [55,] 0.9474336 0.8609794 0.35422992 0.40502745 0.8242140 0.8564569\n [56,] 0.9502617 0.8678099 0.36767253 0.41914657 0.8324994 0.8634743\n [57,] 0.9529452 0.8743537 0.38132405 0.43339934 0.8404698 0.8702006\n [58,] 0.9554907 0.8806181 0.39516567 0.44776316 0.8481302 0.8766429\n [59,] 0.9579046 0.8866107 0.40917743 0.46221469 0.8554860 0.8828085\n [60,] 0.9601930 0.8923393 0.42333828 0.47672999 0.8625432 0.8887050\n [61,] 0.9623620 0.8978118 0.43762620 0.49128470 0.8693085 0.8943404\n [62,] 0.9644171 0.9030364 0.45201835 0.50585421 0.8757887 0.8997226\n [63,] 0.9663639 0.9080212 0.46649120 0.52041377 0.8819913 0.9048599\n [64,] 0.9682077 0.9127745 0.48102068 0.53493875 0.8879237 0.9097603\n [65,] 0.9699536 0.9173046 0.49558233 0.54940470 0.8935939 0.9144322\n [66,] 0.9716064 0.9216195 0.51015147 0.56378762 0.8990099 0.9188838\n [67,] 0.9731709 0.9257276 0.52470339 0.57806401 0.9041798 0.9231233\n [68,] 0.9746513 0.9296368 0.53921348 0.59221112 0.9091117 0.9271587\n [69,] 0.9760521 0.9333550 0.55365741 0.60620702 0.9138140 0.9309982\n [70,] 0.9773773 0.9368901 0.56801131 0.62003077 0.9182949 0.9346496\n [71,] 0.9786308 0.9402497 0.58225190 0.63366250 0.9225625 0.9381205\n [72,] 0.9798162 0.9434412 0.59635664 0.64708355 0.9266251 0.9414187\n [73,] 0.9809371 0.9464720 0.61030389 0.66027651 0.9304906 0.9445515\n [74,] 0.9819970 0.9493490 0.62407301 0.67322534 0.9341669 0.9475261\n [75,] 0.9829989 0.9520793 0.63764447 0.68591540 0.9376618 0.9503495\n [76,] 0.9839460 0.9546694 0.65099998 0.69833347 0.9409829 0.9530285\n [77,] 0.9848412 0.9571259 0.66412253 0.71046781 0.9441376 0.9555697\n [78,] 0.9856871 0.9594548 0.67699648 0.72230814 0.9471331 0.9579795\n [79,] 0.9864865 0.9616624 0.68960761 0.73384566 0.9499766 0.9602640\n [80,] 0.9872419 0.9637543 0.70194313 0.74507301 0.9526747 0.9624292\n [81,] 0.9879555 0.9657361 0.71399174 0.75598422 0.9552341 0.9644808\n [82,] 0.9886296 0.9676131 0.72574360 0.76657474 0.9576613 0.9664243\n [83,] 0.9892665 0.9693906 0.73719032 0.77684129 0.9599624 0.9682649\n [84,] 0.9898680 0.9710735 0.74832496 0.78678190 0.9621434 0.9700077\n [85,] 0.9904362 0.9726665 0.75914198 0.79639575 0.9642100 0.9716577\n [86,] 0.9909728 0.9741740 0.76963720 0.80568319 0.9661678 0.9732193\n [87,] 0.9914795 0.9756005 0.77980776 0.81464557 0.9680220 0.9746972\n [88,] 0.9919580 0.9769501 0.78965200 0.82328526 0.9697778 0.9760955\n [89,] 0.9924099 0.9782267 0.79916948 0.83160548 0.9714400 0.9774184\n [90,] 0.9928365 0.9794341 0.80836083 0.83961027 0.9730133 0.9786696\n [91,] 0.9932394 0.9805759 0.81722774 0.84730442 0.9745023 0.9798529\n [92,] 0.9936197 0.9816554 0.82577280 0.85469335 0.9759111 0.9809719\n [93,] 0.9939787 0.9826760 0.83399952 0.86178305 0.9772439 0.9820298\n [94,] 0.9943177 0.9836408 0.84191214 0.86858003 0.9785046 0.9830300\n [95,] 0.9946377 0.9845527 0.84951566 0.87509120 0.9796969 0.9839754\n [96,] 0.9949398 0.9854145 0.85681567 0.88132386 0.9808243 0.9848689\n [97,] 0.9952249 0.9862289 0.86381832 0.88728558 0.9818903 0.9857133\n [98,] 0.9954940 0.9869985 0.87053025 0.89298417 0.9828981 0.9865113\n [99,] 0.9957480 0.9877255 0.87695848 0.89842764 0.9838507 0.9872652\n[100,] 0.9959878 0.9884124 0.88311041 0.90362411 0.9847511 0.9879776\n```\n:::\n\n```{.r .cell-code}\n# get discrimination\ninf = betas[1, 2]^2 * plogis(logits) * (1 - plogis(logits))\nplotdat  = cbind(z, inf)\n\nas_tibble(plotdat) %>%\n  pivot_longer(2:21) %>%\n  ggplot(., aes(x=z,y=value,col=name))+\n  geom_line(lwd=1)\n```\n\n::: {.cell-output-display}\n![](irt_files/figure-html/unnamed-chunk-10-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n\n\n# as sem\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(lavaan)\nsem_irt_raschel = '\n  # loadings\n  theta =~ l1*item_1 + l1*item_2 + l1*item_3 + l1*item_4\n  \n  # thresholds\n  item_1 | th1*t1\n  item_2 | th2*t1\n  item_3 | th3*t1\n  item_4 | th4*t1\n  \n  # convert loading to discrimination\n  discrm := l1 / sqrt(1-l1^2)\n  \n  # use thresholds to get difficulty   \n  diff_1 := -th1 / sqrt(1-l1^2)\n  diff_2 := -th2 / sqrt(1-l1^2)\n  diff_3 := -th3 / sqrt(1-l1^2)\n  diff_4 := -th4 / sqrt(1-l1^2)\n'\nsem_rasch <- cfa(sem_irt_raschel, data=abdat, std.lv=T)\nsummary(sem_rasch)\n```\n:::\n\n\n\n\n# 2 pm \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nirt_2pm_par1 = ltm(mcq[,-1] ~ z1, IRT.param=F)\nirt_2pm_par2 = ltm(mcq[,-1] ~ z1, IRT.param=T)\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# here are the item coefficients\nbetas <- irt_2pm_par1$coefficients\n# plot across z\nz = seq(-4,4,length.out=100)\n\nlogits = cbind(1,z) %*% t(betas)\nplotdat = cbind(z,plogis(logits))\n\nas_tibble(plotdat) %>%\n  pivot_longer(2:21) %>%\n  ggplot(., aes(x=z,y=value,col=name))+\n  geom_line(lwd=1)\n```\n\n::: {.cell-output-display}\n![](irt_files/figure-html/unnamed-chunk-13-1.png){fig-align='center' width=80%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nbetas <- irt_2pm_par2$coefficients\n# plot across z\nz = seq(-4,4,length.out=100)\n\npi = plogis(cbind(1,z) %*% t(betas))\n# get discrimination\ndiscrim = betas[,2]^2\npr = pi * (1-pi)\nfor(d in 1:length(discrim)){\n  pr[,d] = pr[,d]*discrim[d]\n}\n\nplotdat  = cbind(z, pr)\nas_tibble(plotdat) %>%\n  pivot_longer(2:21) %>%\n  ggplot(., aes(x=z,y=value,col=name))+\n  geom_line(lwd=1)\n```\n\n::: {.cell-output-display}\n![](irt_files/figure-html/unnamed-chunk-14-1.png){fig-align='center' width=80%}\n:::\n:::\n",
    "supporting": [
      "irt_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/panelset-0.2.6/panelset.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/panelset-0.2.6/panelset.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}